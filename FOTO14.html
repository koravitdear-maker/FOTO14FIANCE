<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>เก็บหนี้สะสม 45 คน (Mobile + Animation)</title>
<style>
body { font-family:'Segoe UI',sans-serif; margin:20px; background:#f0f4f7; color:#333; }
h1 { color:#2c3e50; text-align:center; }
#summary { font-size:24px; font-weight:bold; margin-bottom:15px; text-align:center; color:#e67e22; transition: transform 0.3s; }
table { border-collapse: collapse; width:100%; margin:auto; background:#fff; box-shadow:0 5px 15px rgba(0,0,0,0.1); border-radius:8px; overflow:hidden; }
th, td { border:1px solid #ccc; padding:10px; text-align:left; transition: background 0.3s;}
th { background-color:#3498db; color:white; }
tr:nth-child(even) { background-color:#ecf0f1; }
tr:hover { background-color:#d6eaf8; }
tr.paid td { background-color:#2ecc71; color:white; font-weight:bold; transition: background 0.5s;}
input[type=checkbox]{width:25px;height:25px;cursor:pointer;transition:transform 0.2s;}
input[type=checkbox]:hover{transform:scale(1.2);}
button{padding:5px 12px;margin:5px;background:#e74c3c;color:white;border:none;cursor:pointer;border-radius:5px;transition:background 0.3s;}
button:hover{background:#c0392b;}
.container{max-width:1200px;margin:auto;}
/* Responsive */
@media(max-width:768px){
  table{font-size:14px;}
  input[type=checkbox]{width:30px;height:30px;}
  button{padding:8px 14px;font-size:14px;}
}
/* Modal */
.modal { display:none; position:fixed; z-index:100; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.5); }
.modal-content { background:#fff; margin:15% auto; padding:20px; border-radius:8px; width:80%; max-width:400px; text-align:center; }
.modal input { padding:10px; width:80%; margin:10px 0; font-size:16px; }
.modal button { margin-top:10px; }
</style>
</head>
<body>
<div class="container">
<h1>เก็บหนี้สะสม 45 คน (25 บาทต่อวัน)</h1>
<div id="summary">ยอดรวมเงินสะสมทั้งหมด: 0 บาท</div>

<table id="debtTable">
  <thead>
    <tr>
      <th>ชื่อ</th>
      <th>จ่ายแล้ว?</th>
      <th>จำนวนวันสะสม</th>
      <th>เงินสะสม (บาท)</th>
      <th>Undo</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
</div>

<!-- Modal รหัสผ่าน -->
<div id="passModal" class="modal">
  <div class="modal-content">
    <h3>กรุณาใส่รหัสผ่าน</h3>
    <input type="password" id="modalPass" placeholder="รหัสผ่าน">
    <br>
    <button id="modalSubmit">ยืนยัน</button>
    <button id="modalCancel">ยกเลิก</button>
  </div>
</div>

<script>
// รหัสผ่าน
const PASSWORD="1234";

// รายชื่อ 45 คน
const names=[
"กรกฤต อ้ายจุ้ม","กรวิชญ์์ สุยะราช","กรัณย์พล ทวีรัชต์เดชาธร","กฤษณะ ทนันชัย","กิตติภพ งามเถือน",
"คณุตม์ ทองเรไร","จิรพล เวชสุวรรณ์","นภัค มีมาก","ฌษ แก้วศรีงาม","ณภัทร คมขํา",
"ณัฏฐณิชา เดยังรัมย์","ณัฐดนัย สุขนันท์","ณัฐวัชต์ เทพวรรณ","ณัฐศนันท์ โพธารินทร์","ทัศนา สดวิไล",
"ธนภรณ์ เสนีวงศ์ ณ อยุธยา","ธัญจิรา เรือแก้ว","นพัตธร อ่อนอยู่","นันท์นภัส เกกินะ","นัสริน ใสยิด",
"บัวชมภู แมสซิงแฮม หลุยส์","ประภากร กลันพจน์","เปรม เต็งสวัสดิกุล","พงศ์ภรณ์ บุญมานํา","พงศสิน พิจิตรศิริ",
"พรรณนภา เสลภูมิ","พศพัศ คําศรี","ภชร อริยะ","ภวัต กิตติสุรัตน์พงศ์","เมษยา เอียมปาน",
"ลลิตา แก้ววิเศษ","วชิรวิทย์ ทุมมากรณ์","วริษา ทรายแก้ว","วารินทร์ มงคลศิริ","วิรัญชนา พงษ์บ้านไร่",
"วีระพล จรัสศิริเลิศ","ศิริลักษณ ชุมขวัญ","สิริกร ปัจไชยโย","หนึ่งฤทัย สนประเทศ","อังค์ริสา อินต๊ะชุ่ม",
"อาดิศ สัมปัตตะวนิช","เอื้อพันธุ์ หาญจิรกานต์","ออม"
];

const tableBody=document.querySelector("#debtTable tbody");
const summary=document.getElementById("summary");

// สถานะ
let paidStatus={};
let startDates={};
let finalMoney={};

// วันเริ่มสะสม
const systemStartDate=new Date("2025-12-01");
names.forEach((_,i)=>startDates[i]=systemStartDate.toISOString());

// สำหรับ Modal
const modal=document.getElementById("passModal");
const modalInput=document.getElementById("modalPass");
let modalCallback=null;

function showModal(callback){
  modalCallback=callback;
  modal.style.display="block";
  modalInput.value="";
  modalInput.focus();
}
function hideModal(){ modal.style.display="none"; modalCallback=null; }

// Animation ยอดรวม
let lastTotal=0;
function animateSummary(newTotal){
  if(lastTotal===newTotal) return;
  summary.style.transform="scale(1.3)";
  setTimeout(()=>summary.style.transform="scale(1)",200);
  lastTotal=newTotal;
}

// คำนวณวันสะสม
function calculateDays(i){
  if(paidStatus[i]) return 0;
  const start=new Date(startDates[i]);
  const today=new Date();
  const diffTime=today-start;
  return Math.floor(diffTime/(1000*60*60*24))+1;
}

// อัปเดตตาราง
function updateTable(){
  tableBody.innerHTML="";
  let totalMoney=0;
  names.forEach((name,i)=>{
    const tr=document.createElement("tr");
    if(paidStatus[i]) tr.classList.add("paid");

    const tdName=document.createElement("td");
    tdName.textContent=name;
    const tdCheck=document.createElement("td");
    const tdDays=document.createElement("td");
    const tdMoney=document.createElement("td");
    const tdUndo=document.createElement("td");

    const checkbox=document.createElement("input");
    checkbox.type="checkbox";
    checkbox.checked=paidStatus[i]||false;

    const days=calculateDays(i);
    let money=checkbox.checked? finalMoney[i]||0 : days*25;
    tdDays.textContent=checkbox.checked? "-" : days;
    tdMoney.textContent=money;
    totalMoney+=money;

    // checkbox จ่าย
    checkbox.addEventListener("change",()=>{
      if(!checkbox.checked) return;
      showModal(pass=>{
        if(pass!==PASSWORD){ alert("รหัสผ่านไม่ถูกต้อง!"); checkbox.checked=false; hideModal(); return; }
        paidStatus[i]=true;
        finalMoney[i]=money;
        hideModal();
        updateTable();
      });
    });

    // Undo
    const undoBtn=document.createElement("button");
    undoBtn.textContent="Undo";
    undoBtn.addEventListener("click",()=>{
      showModal(pass=>{
        if(pass!==PASSWORD){ alert("รหัสผ่านไม่ถูกต้อง!"); hideModal(); return; }
        paidStatus[i]=false;
        finalMoney[i]=0;
        hideModal();
        updateTable();
      });
    });

    tdCheck.appendChild(checkbox);
    tdUndo.appendChild(undoBtn);
    tr.appendChild(tdName);
    tr.appendChild(tdCheck);
    tr.appendChild(tdDays);
    tr.appendChild(tdMoney);
    tr.appendChild(tdUndo);
    tableBody.appendChild(tr);
  });
  animateSummary(totalMoney);
  summary.textContent=`ยอดรวมเงินสะสมทั้งหมด: ${totalMoney} บาท`;
}

// Modal ปุ่ม
document.getElementById("modalSubmit").addEventListener("click",()=>{
  if(modalCallback) modalCallback(modalInput.value);
});
document.getElementById("modalCancel").addEventListener("click",()=>hideModal());

// เรียกครั้งแรก
updateTable();

// อัปเดตทุก 1 นาที
setInterval(updateTable,60000);
</script>
</body>
</html>
